!function(){"use strict";function t(){d?(clearInterval(i),s.parents(".alert").removeClass("alert-info").addClass("alert-danger"),s.parent().replaceWith("<strong>Error: The email send may have failed, the start time is more than 24 hours ago.</strong>"),c.slideUp()):$.ajax({url:u,data:{pk:r}}).done(function(t){if(t.end)window.location.reload();else if(t.error)s.parents(".alert").text(t.error);else if(new Date-new Date(t.start)>f)d=!0;else{var e=Math.round(t.sent_count/t.total*100);"number"==typeof e?e+="%":e="0%",s.css("width",e).text(e),o.text(t.sent_count+" of "+t.total)}}).fail(function(){clearInterval(i),s.parents(".alert").text("Error retrieving sent email data.")})}function e(){l.hasClass("open-instance-page")?window.location=INSTANCE_URL+r+"#check_on_load":(r=l.siblings("input.email-instance-id").val(),n("/email/instance/"+r+"/cancel/",l))}function n(t){$.ajax({url:t,data:{pk:r}}).success(function(t){l.children(".text").text("Cancelling Instance..."),l.children(".spinner-loader").removeClass("hidden")}).error(function(t,e,n){l.children(".text").text("Cancel This Instance"),l.children(".spinner-loader").addClass("hidden")})}function a(){var n=window.location.hash.replace("#","");c=$(".cancel-instance-form"),s=$(".progress-bar"),l=$(".cancel-instance-btn"),"check_on_load"===n&&l.length>0&&e(),r=$("input.email-instance-id").val(),s.length&&(o=$(".sent"),i=setInterval(t,2e3)),c.on("click",".cancel-instance-btn",function(t){t.preventDefault(),e()})}var r,i,s,o,c,l,u="/instance/json/?pk=",d=!1,f=864e5;$(a)}(),function(){"use strict";function t(){l.find(".attribute").each(function(t){var e=$(this).find("input");e.eq(0).attr("id","id_attributes-"+t+"-id").attr("name","attributes-"+t+"-id"),e.eq(1).attr("id","id_attributes-"+t+"-name").attr("name","attributes-"+t+"-name"),e.eq(2).attr("id","id_attributes-"+t+"-value").attr("name","attributes-"+t+"-value")})}function e(){d.val(l.find(".attribute").length)}function n(t){return t.replace(/\d+/g,function(t){return++t})}function a(a){a.preventDefault();var r=o.clone().removeClass("d-none");r.appendTo(l),c?t():r.find("input").each(function(){$(this).attr("id",n($(this).attr("id"))),$(this).attr("name",n($(this).attr("name")))}),e()}function r(n){n.preventDefault(),c?($(n.target).closest(".attribute").remove(),t()):($(n.target).closest(".attribute").hide(),$(n.target).next().prop("checked",!0)),e()}function i(t){$(t.target).closest(".form-group").toggleClass("alert-"+$(t.target).attr("data-color"))}function s(){c=window.location.pathname.toString().indexOf("recipient/create/")!==-1,o=l.find(".attribute").last().clone().appendTo("body").addClass("d-none"),$("form:first *:input[type=text]:first").focus(),$(".add-attr-btn").on("click",a),l.on("click","span",r),l.on("mouseover","span",i),u.on("mouseover","span",i),l.on("mouseout","span",i),u.on("mouseout","span",i)}var o,c=!1,l=$(".attribute-container"),u=$(".add-attr-container"),d=$("#id_attributes-TOTAL_FORMS");$(s)}(),function(){$("#tb_recipient_search").focus()}(),function(){"use strict";function t(t){var e=$(t.target).parent().attr("data-link-url");e&&(window.location=e)}function e(){$("input").on("blur",function(){$(this).attr("required")&&($(this).val()?$(this).parents(".form-group").removeClass("has-danger").addClass("has-success"):$(this).parents(".form-group").removeClass("has-success").addClass("has-danger"))}),$("select").on("blur",function(){$(this).attr("required")&&($(this).val().length?$(this).parents(".form-group").removeClass("has-danger").addClass("has-success"):$(this).parents(".form-group").removeClass("has-success").addClass("has-danger"))})}function n(){$("table").on("click","td:not(:has(a))",t),$('[data-toggle="tooltip"]').tooltip(),e()}$(n)}();